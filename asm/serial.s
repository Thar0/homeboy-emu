# serial.c
.include "macros.inc"

.section .text, "ax"

.balign 4

glabel serialEvent
/* 093E40 800993E0 7C0802A6 */  mflr	r0
/* 093E44 800993E4 2C040003 */  cmpwi	r4, 3
/* 093E48 800993E8 90010004 */  stw		r0, 4(r1)
/* 093E4C 800993EC 9421FFE0 */  stwu	r1, -0x20(r1)
/* 093E50 800993F0 93E1001C */  stw		r31, 0x1c(r1)
/* 093E54 800993F4 3BE50000 */  addi	r31, r5, 0
/* 093E58 800993F8 93C10018 */  stw		r30, 0x18(r1)
/* 093E5C 800993FC 3BC30000 */  addi	r30, r3, 0
/* 093E60 80099400 418200C4 */  beq		lbl_800994C4
/* 093E64 80099404 40800018 */  bge		lbl_8009941C
/* 093E68 80099408 2C040002 */  cmpwi	r4, 2
/* 093E6C 8009940C 40800028 */  bge		lbl_80099434
/* 093E70 80099410 2C040000 */  cmpwi	r4, 0
/* 093E74 80099414 408000B0 */  bge		lbl_800994C4
/* 093E78 80099418 480000A4 */  b		lbl_800994BC
lbl_8009941C:
/* 093E7C 8009941C 2C041003 */  cmpwi	r4, 0x1003
/* 093E80 80099420 418200A4 */  beq		lbl_800994C4
/* 093E84 80099424 40800098 */  bge		lbl_800994BC
/* 093E88 80099428 2C041002 */  cmpwi	r4, 0x1002
/* 093E8C 8009942C 40800010 */  bge		lbl_8009943C
/* 093E90 80099430 4800008C */  b		lbl_800994BC
lbl_80099434:
/* 093E94 80099434 93FE0000 */  stw		r31, 0(r30)
/* 093E98 80099438 4800008C */  b		lbl_800994C4
lbl_8009943C:
/* 093E9C 8009943C 807E0000 */  lwz		r3, 0(r30)
/* 093EA0 80099440 3CA0800A */  lis		r5, serialPut8@ha
/* 093EA4 80099444 3CC0800A */  lis		r6, serialPut16@ha
/* 093EA8 80099448 3CE0800A */  lis		r7, serialPut32@ha
/* 093EAC 8009944C 80630024 */  lwz		r3, 0x24(r3)
/* 093EB0 80099450 3C80800A */  lis		r4, serialPut64@ha
/* 093EB4 80099454 3904955C */  addi	r8, r4, serialPut64@l
/* 093EB8 80099458 38A596AC */  addi	r5, r5, serialPut8@l
/* 093EBC 8009945C 38C696A4 */  addi	r6, r6, serialPut16@l
/* 093EC0 80099460 38E79564 */  addi	r7, r7, serialPut32@l
/* 093EC4 80099464 389F0000 */  addi	r4, r31, 0
/* 093EC8 80099468 4BF9BAB9 */  bl		cpuSetDevicePut
/* 093ECC 8009946C 2C030000 */  cmpwi	r3, 0
/* 093ED0 80099470 4082000C */  bne		lbl_8009947C
/* 093ED4 80099474 38600000 */  li		r3, 0
/* 093ED8 80099478 48000050 */  b		lbl_800994C8
lbl_8009947C:
/* 093EDC 8009947C 807E0000 */  lwz		r3, 0(r30)
/* 093EE0 80099480 3CA0800A */  lis		r5, serialGet8@ha
/* 093EE4 80099484 3CC0800A */  lis		r6, serialGet16@ha
/* 093EE8 80099488 3CE0800A */  lis		r7, serialGet32@ha
/* 093EEC 8009948C 80630024 */  lwz		r3, 0x24(r3)
/* 093EF0 80099490 3C80800A */  lis		r4, serialGet64@ha
/* 093EF4 80099494 390494E0 */  addi	r8, r4, serialGet64@l
/* 093EF8 80099498 38A59554 */  addi	r5, r5, serialGet8@l
/* 093EFC 8009949C 38C6954C */  addi	r6, r6, serialGet16@l
/* 093F00 800994A0 38E794E8 */  addi	r7, r7, serialGet32@l
/* 093F04 800994A4 389F0000 */  addi	r4, r31, 0
/* 093F08 800994A8 4BF9BA91 */  bl		cpuSetDeviceGet
/* 093F0C 800994AC 2C030000 */  cmpwi	r3, 0
/* 093F10 800994B0 40820014 */  bne		lbl_800994C4
/* 093F14 800994B4 38600000 */  li		r3, 0
/* 093F18 800994B8 48000010 */  b		lbl_800994C8
lbl_800994BC:
/* 093F1C 800994BC 38600000 */  li		r3, 0
/* 093F20 800994C0 48000008 */  b		lbl_800994C8
lbl_800994C4:
/* 093F24 800994C4 38600001 */  li		r3, 1
lbl_800994C8:
/* 093F28 800994C8 80010024 */  lwz		r0, 0x24(r1)
/* 093F2C 800994CC 83E1001C */  lwz		r31, 0x1c(r1)
/* 093F30 800994D0 83C10018 */  lwz		r30, 0x18(r1)
/* 093F34 800994D4 7C0803A6 */  mtlr	r0
/* 093F38 800994D8 38210020 */  addi	r1, r1, 0x20
/* 093F3C 800994DC 4E800020 */  blr		

glabel serialGet64
/* 093F40 800994E0 38600000 */  li		r3, 0
/* 093F44 800994E4 4E800020 */  blr		

glabel serialGet32
/* 093F48 800994E8 548006FE */  clrlwi	r0, r4, 0x1b
/* 093F4C 800994EC 28000018 */  cmplwi	r0, 0x18
/* 093F50 800994F0 4181004C */  bgt		lbl_8009953C
/* 093F54 800994F4 3C808010 */  lis		r4, jtbl_800FC330@ha
/* 093F58 800994F8 3884C330 */  addi	r4, r4, jtbl_800FC330@l
/* 093F5C 800994FC 5400103A */  slwi	r0, r0, 2
/* 093F60 80099500 7C04002E */  lwzx	r0, r4, r0
/* 093F64 80099504 7C0903A6 */  mtctr	r0
/* 093F68 80099508 4E800420 */  bctr	
glabel lbl_8009950C
/* 093F6C 8009950C 80030004 */  lwz		r0, 4(r3)
/* 093F70 80099510 90050000 */  stw		r0, 0(r5)
/* 093F74 80099514 48000030 */  b		lbl_80099544
glabel lbl_80099518
/* 093F78 80099518 38000000 */  li		r0, 0
/* 093F7C 8009951C 90050000 */  stw		r0, 0(r5)
/* 093F80 80099520 48000024 */  b		lbl_80099544
glabel lbl_80099524
/* 093F84 80099524 38000000 */  li		r0, 0
/* 093F88 80099528 90050000 */  stw		r0, 0(r5)
/* 093F8C 8009952C 48000018 */  b		lbl_80099544
glabel lbl_80099530
/* 093F90 80099530 38000000 */  li		r0, 0
/* 093F94 80099534 90050000 */  stw		r0, 0(r5)
/* 093F98 80099538 4800000C */  b		lbl_80099544
glabel lbl_8009953C
/* 093F9C 8009953C 38600000 */  li		r3, 0
/* 093FA0 80099540 4E800020 */  blr		
lbl_80099544:
/* 093FA4 80099544 38600001 */  li		r3, 1
/* 093FA8 80099548 4E800020 */  blr		

glabel serialGet16
/* 093FAC 8009954C 38600000 */  li		r3, 0
/* 093FB0 80099550 4E800020 */  blr		

glabel serialGet8
/* 093FB4 80099554 38600000 */  li		r3, 0
/* 093FB8 80099558 4E800020 */  blr		

glabel serialPut64
/* 093FBC 8009955C 38600000 */  li		r3, 0
/* 093FC0 80099560 4E800020 */  blr		

glabel serialPut32
/* 093FC4 80099564 7C0802A6 */  mflr	r0
/* 093FC8 80099568 90010004 */  stw		r0, 4(r1)
/* 093FCC 8009956C 548006FE */  clrlwi	r0, r4, 0x1b
/* 093FD0 80099570 28000018 */  cmplwi	r0, 0x18
/* 093FD4 80099574 9421FFD8 */  stwu	r1, -0x28(r1)
/* 093FD8 80099578 93E10024 */  stw		r31, 0x24(r1)
/* 093FDC 8009957C 3BE30000 */  addi	r31, r3, 0
/* 093FE0 80099580 41810104 */  bgt		lbl_80099684
/* 093FE4 80099584 3C608010 */  lis		r3, jtbl_800FC394@ha
/* 093FE8 80099588 3863C394 */  addi	r3, r3, jtbl_800FC394@l
/* 093FEC 8009958C 5400103A */  slwi	r0, r0, 2
/* 093FF0 80099590 7C03002E */  lwzx	r0, r3, r0
/* 093FF4 80099594 7C0903A6 */  mtctr	r0
/* 093FF8 80099598 4E800420 */  bctr	
glabel lbl_8009959C
/* 093FFC 8009959C 80050000 */  lwz		r0, 0(r5)
/* 094000 800995A0 901F0004 */  stw		r0, 4(r31)
/* 094004 800995A4 480000E8 */  b		lbl_8009968C
glabel lbl_800995A8
/* 094008 800995A8 38000040 */  li		r0, 0x40
/* 09400C 800995AC 90010018 */  stw		r0, 0x18(r1)
/* 094010 800995B0 38810014 */  addi	r4, r1, 0x14
/* 094014 800995B4 38C10018 */  addi	r6, r1, 0x18
/* 094018 800995B8 807F0000 */  lwz		r3, 0(r31)
/* 09401C 800995BC 80BF0004 */  lwz		r5, 4(r31)
/* 094020 800995C0 8063002C */  lwz		r3, 0x2c(r3)
/* 094024 800995C4 4BFD8D11 */  bl		ramGetBuffer
/* 094028 800995C8 2C030000 */  cmpwi	r3, 0
/* 09402C 800995CC 4082000C */  bne		lbl_800995D8
/* 094030 800995D0 38600000 */  li		r3, 0
/* 094034 800995D4 480000BC */  b		lbl_80099690
lbl_800995D8:
/* 094038 800995D8 807F0000 */  lwz		r3, 0(r31)
/* 09403C 800995DC 80810014 */  lwz		r4, 0x14(r1)
/* 094040 800995E0 80630028 */  lwz		r3, 0x28(r3)
/* 094044 800995E4 4BFD7CE1 */  bl		pifGetData
/* 094048 800995E8 2C030000 */  cmpwi	r3, 0
/* 09404C 800995EC 4082000C */  bne		lbl_800995F8
/* 094050 800995F0 38600000 */  li		r3, 0
/* 094054 800995F4 4800009C */  b		lbl_80099690
lbl_800995F8:
/* 094058 800995F8 807F0000 */  lwz		r3, 0(r31)
/* 09405C 800995FC 38801000 */  li		r4, 0x1000
/* 094060 80099600 38A00006 */  li		r5, 6
/* 094064 80099604 4BF6EC51 */  bl		xlObjectEvent
/* 094068 80099608 48000084 */  b		lbl_8009968C
glabel lbl_8009960C
/* 09406C 8009960C 38000040 */  li		r0, 0x40
/* 094070 80099610 90010018 */  stw		r0, 0x18(r1)
/* 094074 80099614 38810014 */  addi	r4, r1, 0x14
/* 094078 80099618 38C10018 */  addi	r6, r1, 0x18
/* 09407C 8009961C 807F0000 */  lwz		r3, 0(r31)
/* 094080 80099620 80BF0004 */  lwz		r5, 4(r31)
/* 094084 80099624 8063002C */  lwz		r3, 0x2c(r3)
/* 094088 80099628 4BFD8CAD */  bl		ramGetBuffer
/* 09408C 8009962C 2C030000 */  cmpwi	r3, 0
/* 094090 80099630 4082000C */  bne		lbl_8009963C
/* 094094 80099634 38600000 */  li		r3, 0
/* 094098 80099638 48000058 */  b		lbl_80099690
lbl_8009963C:
/* 09409C 8009963C 807F0000 */  lwz		r3, 0(r31)
/* 0940A0 80099640 80810014 */  lwz		r4, 0x14(r1)
/* 0940A4 80099644 80630028 */  lwz		r3, 0x28(r3)
/* 0940A8 80099648 4BFD7CE9 */  bl		pifSetData
/* 0940AC 8009964C 2C030000 */  cmpwi	r3, 0
/* 0940B0 80099650 4082000C */  bne		lbl_8009965C
/* 0940B4 80099654 38600000 */  li		r3, 0
/* 0940B8 80099658 48000038 */  b		lbl_80099690
lbl_8009965C:
/* 0940BC 8009965C 807F0000 */  lwz		r3, 0(r31)
/* 0940C0 80099660 38801000 */  li		r4, 0x1000
/* 0940C4 80099664 38A00006 */  li		r5, 6
/* 0940C8 80099668 4BF6EBED */  bl		xlObjectEvent
/* 0940CC 8009966C 48000020 */  b		lbl_8009968C
glabel lbl_80099670
/* 0940D0 80099670 807F0000 */  lwz		r3, 0(r31)
/* 0940D4 80099674 38801001 */  li		r4, 0x1001
/* 0940D8 80099678 38A00006 */  li		r5, 6
/* 0940DC 8009967C 4BF6EBD9 */  bl		xlObjectEvent
/* 0940E0 80099680 4800000C */  b		lbl_8009968C
glabel lbl_80099684
/* 0940E4 80099684 38600000 */  li		r3, 0
/* 0940E8 80099688 48000008 */  b		lbl_80099690
lbl_8009968C:
/* 0940EC 8009968C 38600001 */  li		r3, 1
lbl_80099690:
/* 0940F0 80099690 8001002C */  lwz		r0, 0x2c(r1)
/* 0940F4 80099694 83E10024 */  lwz		r31, 0x24(r1)
/* 0940F8 80099698 38210028 */  addi	r1, r1, 0x28
/* 0940FC 8009969C 7C0803A6 */  mtlr	r0
/* 094100 800996A0 4E800020 */  blr		

glabel serialPut16
/* 094104 800996A4 38600000 */  li		r3, 0
/* 094108 800996A8 4E800020 */  blr		

glabel serialPut8
/* 09410C 800996AC 38600000 */  li		r3, 0
/* 094110 800996B0 4E800020 */  blr		


.section .data, "wa"

.balign 8

/* 000F93A0 800FC320 0010 */
glabel gClassSerial
    .long D_801455D0, 0x00000008, 0x00000000, serialEvent

.balign 4

/* 000F93B0 800FC330 0064 */
jtbl_800FC330:
    .long lbl_8009950C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_80099518
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_80099524
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_8009953C
    .long lbl_80099530

.balign 4

/* 000F9414 800FC394 0064 */
jtbl_800FC394:
    .long lbl_8009959C
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_800995A8
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_8009960C
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099684
    .long lbl_80099670


.section .sdata, "wa"

.balign 8

/* 000FFE30 801455D0 0007 */
D_801455D0:
    .asciz "SERIAL"


