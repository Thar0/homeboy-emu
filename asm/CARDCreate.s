# CARDCreate.c
.include "macros.inc"

.section .text, "ax"

.balign 4

CreateCallbackFat:
/* 0C6F84 800CC524 7C0802A6 */  mflr    r0
/* 0C6F88 800CC528 90010004 */  stw     r0, 4(r1)
/* 0C6F8C 800CC52C 9421FFD8 */  stwu    r1, -0x28(r1)
/* 0C6F90 800CC530 BF610014 */  stmw    r27, 0x14(r1)
/* 0C6F94 800CC534 3B830000 */  addi    r28, r3, 0
/* 0C6F98 800CC538 3C608014 */  lis     r3, __CARDBlock@ha
/* 0C6F9C 800CC53C 1CBC0110 */  mulli   r5, r28, 0x110
/* 0C6FA0 800CC540 380324D0 */  addi    r0, r3, __CARDBlock@l
/* 0C6FA4 800CC544 7FE02A14 */  add     r31, r0, r5
/* 0C6FA8 800CC548 83BF00D0 */  lwz     r29, 0xd0(r31)
/* 0C6FAC 800CC54C 3B600000 */  li      r27, 0
/* 0C6FB0 800CC550 7C9E2379 */  or.     r30, r4, r4
/* 0C6FB4 800CC554 937F00D0 */  stw     r27, 0xd0(r31)
/* 0C6FB8 800CC558 418000C0 */  blt     lbl_800CC618
/* 0C6FBC 800CC55C 7FE3FB78 */  mr      r3, r31
/* 0C6FC0 800CC560 4BFFD569 */  bl      __CARDGetDirBlock
/* 0C6FC4 800CC564 A01F00BC */  lhz     r0, 0xbc(r31)
/* 0C6FC8 800CC568 38A00004 */  li      r5, 4
/* 0C6FCC 800CC56C 809F010C */  lwz     r4, 0x10c(r31)
/* 0C6FD0 800CC570 54003032 */  slwi    r0, r0, 6
/* 0C6FD4 800CC574 7FC30214 */  add     r30, r3, r0
/* 0C6FD8 800CC578 387E0000 */  addi    r3, r30, 0
/* 0C6FDC 800CC57C 4BF38F49 */  bl      memcpy
/* 0C6FE0 800CC580 809F010C */  lwz     r4, 0x10c(r31)
/* 0C6FE4 800CC584 387E0004 */  addi    r3, r30, 4
/* 0C6FE8 800CC588 38A00002 */  li      r5, 2
/* 0C6FEC 800CC58C 38840004 */  addi    r4, r4, 4
/* 0C6FF0 800CC590 4BF38F35 */  bl      memcpy
/* 0C6FF4 800CC594 38000004 */  li      r0, 4
/* 0C6FF8 800CC598 981E0034 */  stb     r0, 0x34(r30)
/* 0C6FFC 800CC59C 3800FFFF */  li      r0, -1
/* 0C7000 800CC5A0 3C608000 */  lis     r3, 0x8000
/* 0C7004 800CC5A4 9B7E0035 */  stb     r27, 0x35(r30)
/* 0C7008 800CC5A8 A09F00BE */  lhz     r4, 0xbe(r31)
/* 0C700C 800CC5AC B09E0036 */  sth     r4, 0x36(r30)
/* 0C7010 800CC5B0 9B7E0007 */  stb     r27, 7(r30)
/* 0C7014 800CC5B4 901E002C */  stw     r0, 0x2c(r30)
/* 0C7018 800CC5B8 B37E0030 */  sth     r27, 0x30(r30)
/* 0C701C 800CC5BC B37E0032 */  sth     r27, 0x32(r30)
/* 0C7020 800CC5C0 901E003C */  stw     r0, 0x3c(r30)
/* 0C7024 800CC5C4 A01E0032 */  lhz     r0, 0x32(r30)
/* 0C7028 800CC5C8 5400003A */  rlwinm  r0, r0, 0, 0, 0x1d
/* 0C702C 800CC5CC 60000001 */  ori     r0, r0, 1
/* 0C7030 800CC5D0 B01E0032 */  sth     r0, 0x32(r30)
/* 0C7034 800CC5D4 809F00C0 */  lwz     r4, 0xc0(r31)
/* 0C7038 800CC5D8 93640008 */  stw     r27, 8(r4)
/* 0C703C 800CC5DC A01E0036 */  lhz     r0, 0x36(r30)
/* 0C7040 800CC5E0 809F00C0 */  lwz     r4, 0xc0(r31)
/* 0C7044 800CC5E4 B0040010 */  sth     r0, 0x10(r4)
/* 0C7048 800CC5E8 800300F8 */  lwz     r0, 0xf8(r3)
/* 0C704C 800CC5EC 541BF0BE */  srwi    r27, r0, 2
/* 0C7050 800CC5F0 4BFE172D */  bl      OSGetTime
/* 0C7054 800CC5F4 38DB0000 */  addi    r6, r27, 0
/* 0C7058 800CC5F8 38A00000 */  li      r5, 0
/* 0C705C 800CC5FC 4800D5AD */  bl      __div2i
/* 0C7060 800CC600 909E0028 */  stw     r4, 0x28(r30)
/* 0C7064 800CC604 387C0000 */  addi    r3, r28, 0
/* 0C7068 800CC608 389D0000 */  addi    r4, r29, 0
/* 0C706C 800CC60C 4BFFD65D */  bl      __CARDUpdateDir
/* 0C7070 800CC610 7C7E1B79 */  or.     r30, r3, r3
/* 0C7074 800CC614 4080002C */  bge     lbl_800CC640
lbl_800CC618:
/* 0C7078 800CC618 387F0000 */  addi    r3, r31, 0
/* 0C707C 800CC61C 389E0000 */  addi    r4, r30, 0
/* 0C7080 800CC620 4BFFB8E1 */  bl      __CARDPutControlBlock
/* 0C7084 800CC624 281D0000 */  cmplwi  r29, 0
/* 0C7088 800CC628 41820018 */  beq     lbl_800CC640
/* 0C708C 800CC62C 399D0000 */  addi    r12, r29, 0
/* 0C7090 800CC630 7D8803A6 */  mtlr    r12
/* 0C7094 800CC634 387C0000 */  addi    r3, r28, 0
/* 0C7098 800CC638 389E0000 */  addi    r4, r30, 0
/* 0C709C 800CC63C 4E800021 */  blrl    
lbl_800CC640:
/* 0C70A0 800CC640 BB610014 */  lmw     r27, 0x14(r1)
/* 0C70A4 800CC644 8001002C */  lwz     r0, 0x2c(r1)
/* 0C70A8 800CC648 38210028 */  addi    r1, r1, 0x28
/* 0C70AC 800CC64C 7C0803A6 */  mtlr    r0
/* 0C70B0 800CC650 4E800020 */  blr     

glabel CARDCreateAsync
/* 0C70B4 800CC654 7C0802A6 */  mflr    r0
/* 0C70B8 800CC658 90010004 */  stw     r0, 4(r1)
/* 0C70BC 800CC65C 9421FFB8 */  stwu    r1, -0x48(r1)
/* 0C70C0 800CC660 BEE10024 */  stmw    r23, 0x24(r1)
/* 0C70C4 800CC664 3B440000 */  addi    r26, r4, 0
/* 0C70C8 800CC668 3B230000 */  addi    r25, r3, 0
/* 0C70CC 800CC66C 3B650000 */  addi    r27, r5, 0
/* 0C70D0 800CC670 3B860000 */  addi    r28, r6, 0
/* 0C70D4 800CC674 3BA70000 */  addi    r29, r7, 0
/* 0C70D8 800CC678 387A0000 */  addi    r3, r26, 0
/* 0C70DC 800CC67C 48010599 */  bl      strlen
/* 0C70E0 800CC680 28030020 */  cmplwi  r3, 0x20
/* 0C70E4 800CC684 4081000C */  ble     lbl_800CC690
/* 0C70E8 800CC688 3860FFF4 */  li      r3, -12
/* 0C70EC 800CC68C 480001D4 */  b       lbl_800CC860
lbl_800CC690:
/* 0C70F0 800CC690 38790000 */  addi    r3, r25, 0
/* 0C70F4 800CC694 3881001C */  addi    r4, r1, 0x1c
/* 0C70F8 800CC698 4BFFB7B1 */  bl      __CARDGetControlBlock
/* 0C70FC 800CC69C 2C030000 */  cmpwi   r3, 0
/* 0C7100 800CC6A0 40800008 */  bge     lbl_800CC6A8
/* 0C7104 800CC6A4 480001BC */  b       lbl_800CC860
lbl_800CC6A8:
/* 0C7108 800CC6A8 281B0000 */  cmplwi  r27, 0
/* 0C710C 800CC6AC 4182001C */  beq     lbl_800CC6C8
/* 0C7110 800CC6B0 8061001C */  lwz     r3, 0x1c(r1)
/* 0C7114 800CC6B4 8083000C */  lwz     r4, 0xc(r3)
/* 0C7118 800CC6B8 7C1B2396 */  divwu   r0, r27, r4
/* 0C711C 800CC6BC 7C0021D6 */  mullw   r0, r0, r4
/* 0C7120 800CC6C0 7C00D851 */  subf.   r0, r0, r27
/* 0C7124 800CC6C4 4182000C */  beq     lbl_800CC6D0
lbl_800CC6C8:
/* 0C7128 800CC6C8 3860FF80 */  li      r3, -128
/* 0C712C 800CC6CC 48000194 */  b       lbl_800CC860
lbl_800CC6D0:
/* 0C7130 800CC6D0 3C800001 */  lis     r4, 1
/* 0C7134 800CC6D4 3BC4FFFF */  addi    r30, r4, -1
/* 0C7138 800CC6D8 4BFFD3F1 */  bl      __CARDGetDirBlock
/* 0C713C 800CC6DC 3BE30000 */  addi    r31, r3, 0
/* 0C7140 800CC6E0 3B1F0000 */  addi    r24, r31, 0
/* 0C7144 800CC6E4 3AE00000 */  li      r23, 0
/* 0C7148 800CC6E8 4800008C */  b       lbl_800CC774
lbl_800CC6EC:
/* 0C714C 800CC6EC 88180000 */  lbz     r0, 0(r24)
/* 0C7150 800CC6F0 280000FF */  cmplwi  r0, 0xff
/* 0C7154 800CC6F4 40820018 */  bne     lbl_800CC70C
/* 0C7158 800CC6F8 57C0043E */  clrlwi  r0, r30, 0x10
/* 0C715C 800CC6FC 2800FFFF */  cmplwi  r0, 0xffff
/* 0C7160 800CC700 4082006C */  bne     lbl_800CC76C
/* 0C7164 800CC704 7EFEBB78 */  mr      r30, r23
/* 0C7168 800CC708 48000064 */  b       lbl_800CC76C
lbl_800CC70C:
/* 0C716C 800CC70C 8081001C */  lwz     r4, 0x1c(r1)
/* 0C7170 800CC710 38780000 */  addi    r3, r24, 0
/* 0C7174 800CC714 38A00004 */  li      r5, 4
/* 0C7178 800CC718 8084010C */  lwz     r4, 0x10c(r4)
/* 0C717C 800CC71C 4800E381 */  bl      memcmp
/* 0C7180 800CC720 2C030000 */  cmpwi   r3, 0
/* 0C7184 800CC724 40820048 */  bne     lbl_800CC76C
/* 0C7188 800CC728 8081001C */  lwz     r4, 0x1c(r1)
/* 0C718C 800CC72C 38780004 */  addi    r3, r24, 4
/* 0C7190 800CC730 38A00002 */  li      r5, 2
/* 0C7194 800CC734 8084010C */  lwz     r4, 0x10c(r4)
/* 0C7198 800CC738 38840004 */  addi    r4, r4, 4
/* 0C719C 800CC73C 4800E361 */  bl      memcmp
/* 0C71A0 800CC740 2C030000 */  cmpwi   r3, 0
/* 0C71A4 800CC744 40820028 */  bne     lbl_800CC76C
/* 0C71A8 800CC748 38780000 */  addi    r3, r24, 0
/* 0C71AC 800CC74C 389A0000 */  addi    r4, r26, 0
/* 0C71B0 800CC750 4BFFF7E9 */  bl      __CARDCompareFileName
/* 0C71B4 800CC754 2C030000 */  cmpwi   r3, 0
/* 0C71B8 800CC758 41820014 */  beq     lbl_800CC76C
/* 0C71BC 800CC75C 8061001C */  lwz     r3, 0x1c(r1)
/* 0C71C0 800CC760 3880FFF9 */  li      r4, -7
/* 0C71C4 800CC764 4BFFB79D */  bl      __CARDPutControlBlock
/* 0C71C8 800CC768 480000F8 */  b       lbl_800CC860
lbl_800CC76C:
/* 0C71CC 800CC76C 3B180040 */  addi    r24, r24, 0x40
/* 0C71D0 800CC770 3AF70001 */  addi    r23, r23, 1
lbl_800CC774:
/* 0C71D4 800CC774 56E0043E */  clrlwi  r0, r23, 0x10
/* 0C71D8 800CC778 2800007F */  cmplwi  r0, 0x7f
/* 0C71DC 800CC77C 4180FF70 */  blt     lbl_800CC6EC
/* 0C71E0 800CC780 57C0043E */  clrlwi  r0, r30, 0x10
/* 0C71E4 800CC784 2800FFFF */  cmplwi  r0, 0xffff
/* 0C71E8 800CC788 40820014 */  bne     lbl_800CC79C
/* 0C71EC 800CC78C 8061001C */  lwz     r3, 0x1c(r1)
/* 0C71F0 800CC790 3880FFF8 */  li      r4, -8
/* 0C71F4 800CC794 4BFFB76D */  bl      __CARDPutControlBlock
/* 0C71F8 800CC798 480000C8 */  b       lbl_800CC860
lbl_800CC79C:
/* 0C71FC 800CC79C 8061001C */  lwz     r3, 0x1c(r1)
/* 0C7200 800CC7A0 4BFFCF25 */  bl      __CARDGetFatBlock
/* 0C7204 800CC7A4 8081001C */  lwz     r4, 0x1c(r1)
/* 0C7208 800CC7A8 A0030006 */  lhz     r0, 6(r3)
/* 0C720C 800CC7AC 8064000C */  lwz     r3, 0xc(r4)
/* 0C7210 800CC7B0 7C0301D6 */  mullw   r0, r3, r0
/* 0C7214 800CC7B4 7C00D840 */  cmplw   r0, r27
/* 0C7218 800CC7B8 40800014 */  bge     lbl_800CC7CC
/* 0C721C 800CC7BC 38640000 */  addi    r3, r4, 0
/* 0C7220 800CC7C0 3880FFF7 */  li      r4, -9
/* 0C7224 800CC7C4 4BFFB73D */  bl      __CARDPutControlBlock
/* 0C7228 800CC7C8 48000098 */  b       lbl_800CC860
lbl_800CC7CC:
/* 0C722C 800CC7CC 281D0000 */  cmplwi  r29, 0
/* 0C7230 800CC7D0 4182000C */  beq     lbl_800CC7DC
/* 0C7234 800CC7D4 7FA0EB78 */  mr      r0, r29
/* 0C7238 800CC7D8 4800000C */  b       lbl_800CC7E4
lbl_800CC7DC:
/* 0C723C 800CC7DC 3C60800C */  lis     r3, __CARDDefaultApiCallback@ha
/* 0C7240 800CC7E0 38036EE8 */  addi    r0, r3, __CARDDefaultApiCallback@l
lbl_800CC7E4:
/* 0C7244 800CC7E4 900400D0 */  stw     r0, 0xd0(r4)
/* 0C7248 800CC7E8 57C032B2 */  rlwinm  r0, r30, 6, 0xa, 0x19
/* 0C724C 800CC7EC 7CFF0214 */  add     r7, r31, r0
/* 0C7250 800CC7F0 8061001C */  lwz     r3, 0x1c(r1)
/* 0C7254 800CC7F4 57DD043E */  clrlwi  r29, r30, 0x10
/* 0C7258 800CC7F8 389A0000 */  addi    r4, r26, 0
/* 0C725C 800CC7FC B3C300BC */  sth     r30, 0xbc(r3)
/* 0C7260 800CC800 38670008 */  addi    r3, r7, 8
/* 0C7264 800CC804 38A00020 */  li      r5, 0x20
/* 0C7268 800CC808 80C1001C */  lwz     r6, 0x1c(r1)
/* 0C726C 800CC80C 8006000C */  lwz     r0, 0xc(r6)
/* 0C7270 800CC810 7C1B0396 */  divwu   r0, r27, r0
/* 0C7274 800CC814 B0070038 */  sth     r0, 0x38(r7)
/* 0C7278 800CC818 48010305 */  bl      strncpy
/* 0C727C 800CC81C 8081001C */  lwz     r4, 0x1c(r1)
/* 0C7280 800CC820 3C60800D */  lis     r3, CreateCallbackFat@ha
/* 0C7284 800CC824 38A3C524 */  addi    r5, r3, CreateCallbackFat@l
/* 0C7288 800CC828 938400C0 */  stw     r28, 0xc0(r4)
/* 0C728C 800CC82C 7F23CB78 */  mr      r3, r25
/* 0C7290 800CC830 933C0000 */  stw     r25, 0(r28)
/* 0C7294 800CC834 93BC0004 */  stw     r29, 4(r28)
/* 0C7298 800CC838 8081001C */  lwz     r4, 0x1c(r1)
/* 0C729C 800CC83C 8004000C */  lwz     r0, 0xc(r4)
/* 0C72A0 800CC840 7C9B0396 */  divwu   r4, r27, r0
/* 0C72A4 800CC844 4BFFD025 */  bl      __CARDAllocBlock
/* 0C72A8 800CC848 7C641B79 */  or.     r4, r3, r3
/* 0C72AC 800CC84C 40800010 */  bge     lbl_800CC85C
/* 0C72B0 800CC850 8061001C */  lwz     r3, 0x1c(r1)
/* 0C72B4 800CC854 4BFFB6AD */  bl      __CARDPutControlBlock
/* 0C72B8 800CC858 48000008 */  b       lbl_800CC860
lbl_800CC85C:
/* 0C72BC 800CC85C 7C832378 */  mr      r3, r4
lbl_800CC860:
/* 0C72C0 800CC860 BAE10024 */  lmw     r23, 0x24(r1)
/* 0C72C4 800CC864 8001004C */  lwz     r0, 0x4c(r1)
/* 0C72C8 800CC868 38210048 */  addi    r1, r1, 0x48
/* 0C72CC 800CC86C 7C0803A6 */  mtlr    r0
/* 0C72D0 800CC870 4E800020 */  blr     


