# mainloop.c
.include "macros.inc"

.section .text, "ax"

.balign 4

glabel TRKHandleRequestEvent
/* 0CFC2C 800D51CC 7C0802A6 */  mflr    r0
/* 0CFC30 800D51D0 90010004 */  stw     r0, 4(r1)
/* 0CFC34 800D51D4 9421FFF8 */  stwu    r1, -8(r1)
/* 0CFC38 800D51D8 80630008 */  lwz     r3, 8(r3)
/* 0CFC3C 800D51DC 4800068D */  bl      TRKGetBuffer
/* 0CFC40 800D51E0 48000F95 */  bl      TRKDispatchMessage
/* 0CFC44 800D51E4 38210008 */  addi    r1, r1, 8
/* 0CFC48 800D51E8 80010004 */  lwz     r0, 4(r1)
/* 0CFC4C 800D51EC 7C0803A6 */  mtlr    r0
/* 0CFC50 800D51F0 4E800020 */  blr     

glabel TRKHandleSupportEvent
/* 0CFC54 800D51F4 7C0802A6 */  mflr    r0
/* 0CFC58 800D51F8 90010004 */  stw     r0, 4(r1)
/* 0CFC5C 800D51FC 9421FFF8 */  stwu    r1, -8(r1)
/* 0CFC60 800D5200 48003951 */  bl      TRKTargetSupportRequest
/* 0CFC64 800D5204 38210008 */  addi    r1, r1, 8
/* 0CFC68 800D5208 80010004 */  lwz     r0, 4(r1)
/* 0CFC6C 800D520C 7C0803A6 */  mtlr    r0
/* 0CFC70 800D5210 4E800020 */  blr     

glabel TRKIdle
/* 0CFC74 800D5214 7C0802A6 */  mflr    r0
/* 0CFC78 800D5218 90010004 */  stw     r0, 4(r1)
/* 0CFC7C 800D521C 9421FFF8 */  stwu    r1, -8(r1)
/* 0CFC80 800D5220 48003A5D */  bl      TRKTargetStopped
/* 0CFC84 800D5224 2C030000 */  cmpwi   r3, 0
/* 0CFC88 800D5228 40820008 */  bne     lbl_800D5230
/* 0CFC8C 800D522C 480046C5 */  bl      TRKTargetContinue
lbl_800D5230:
/* 0CFC90 800D5230 38210008 */  addi    r1, r1, 8
/* 0CFC94 800D5234 80010004 */  lwz     r0, 4(r1)
/* 0CFC98 800D5238 7C0803A6 */  mtlr    r0
/* 0CFC9C 800D523C 4E800020 */  blr     

glabel TRKNubMainLoop
/* 0CFCA0 800D5240 7C0802A6 */  mflr    r0
/* 0CFCA4 800D5244 3C608014 */  lis     r3, gTRKInputPendingPtr@ha
/* 0CFCA8 800D5248 90010004 */  stw     r0, 4(r1)
/* 0CFCAC 800D524C 9421FFE0 */  stwu    r1, -0x20(r1)
/* 0CFCB0 800D5250 93E1001C */  stw     r31, 0x1c(r1)
/* 0CFCB4 800D5254 3BE34244 */  addi    r31, r3, gTRKInputPendingPtr@l
/* 0CFCB8 800D5258 93C10018 */  stw     r30, 0x18(r1)
/* 0CFCBC 800D525C 3BC00000 */  li      r30, 0
/* 0CFCC0 800D5260 93A10014 */  stw     r29, 0x14(r1)
/* 0CFCC4 800D5264 3BA00000 */  li      r29, 0
/* 0CFCC8 800D5268 480000A8 */  b       lbl_800D5310
lbl_800D526C:
/* 0CFCCC 800D526C 38610008 */  addi    r3, r1, 8
/* 0CFCD0 800D5270 48000145 */  bl      TRKGetNextEvent
/* 0CFCD4 800D5274 2C030000 */  cmpwi   r3, 0
/* 0CFCD8 800D5278 4182006C */  beq     lbl_800D52E4
/* 0CFCDC 800D527C 88010008 */  lbz     r0, 8(r1)
/* 0CFCE0 800D5280 3BA00000 */  li      r29, 0
/* 0CFCE4 800D5284 2C000002 */  cmpwi   r0, 2
/* 0CFCE8 800D5288 41820028 */  beq     lbl_800D52B0
/* 0CFCEC 800D528C 40800014 */  bge     lbl_800D52A0
/* 0CFCF0 800D5290 2C000000 */  cmpwi   r0, 0
/* 0CFCF4 800D5294 41820044 */  beq     lbl_800D52D8
/* 0CFCF8 800D5298 40800024 */  bge     lbl_800D52BC
/* 0CFCFC 800D529C 4800003C */  b       lbl_800D52D8
lbl_800D52A0:
/* 0CFD00 800D52A0 2C000005 */  cmpwi   r0, 5
/* 0CFD04 800D52A4 4182002C */  beq     lbl_800D52D0
/* 0CFD08 800D52A8 40800030 */  bge     lbl_800D52D8
/* 0CFD0C 800D52AC 48000018 */  b       lbl_800D52C4
lbl_800D52B0:
/* 0CFD10 800D52B0 38610008 */  addi    r3, r1, 8
/* 0CFD14 800D52B4 4BFFFF19 */  bl      TRKHandleRequestEvent
/* 0CFD18 800D52B8 48000020 */  b       lbl_800D52D8
lbl_800D52BC:
/* 0CFD1C 800D52BC 3BC00001 */  li      r30, 1
/* 0CFD20 800D52C0 48000018 */  b       lbl_800D52D8
lbl_800D52C4:
/* 0CFD24 800D52C4 38610008 */  addi    r3, r1, 8
/* 0CFD28 800D52C8 480034D9 */  bl      TRKTargetInterrupt
/* 0CFD2C 800D52CC 4800000C */  b       lbl_800D52D8
lbl_800D52D0:
/* 0CFD30 800D52D0 38610008 */  addi    r3, r1, 8
/* 0CFD34 800D52D4 4BFFFF21 */  bl      TRKHandleSupportEvent
lbl_800D52D8:
/* 0CFD38 800D52D8 38610008 */  addi    r3, r1, 8
/* 0CFD3C 800D52DC 48000291 */  bl      TRKDestructEvent
/* 0CFD40 800D52E0 48000030 */  b       lbl_800D5310
lbl_800D52E4:
/* 0CFD44 800D52E4 2C1D0000 */  cmpwi   r29, 0
/* 0CFD48 800D52E8 41820014 */  beq     lbl_800D52FC
/* 0CFD4C 800D52EC 807F0000 */  lwz     r3, 0(r31)
/* 0CFD50 800D52F0 88030000 */  lbz     r0, 0(r3)
/* 0CFD54 800D52F4 28000000 */  cmplwi  r0, 0
/* 0CFD58 800D52F8 41820010 */  beq     lbl_800D5308
lbl_800D52FC:
/* 0CFD5C 800D52FC 3BA00001 */  li      r29, 1
/* 0CFD60 800D5300 48000D65 */  bl      TRKGetInput
/* 0CFD64 800D5304 4800000C */  b       lbl_800D5310
lbl_800D5308:
/* 0CFD68 800D5308 4BFFFF0D */  bl      TRKIdle
/* 0CFD6C 800D530C 3BA00000 */  li      r29, 0
lbl_800D5310:
/* 0CFD70 800D5310 2C1E0000 */  cmpwi   r30, 0
/* 0CFD74 800D5314 4182FF58 */  beq     lbl_800D526C
/* 0CFD78 800D5318 83E1001C */  lwz     r31, 0x1c(r1)
/* 0CFD7C 800D531C 83C10018 */  lwz     r30, 0x18(r1)
/* 0CFD80 800D5320 83A10014 */  lwz     r29, 0x14(r1)
/* 0CFD84 800D5324 38210020 */  addi    r1, r1, 0x20
/* 0CFD88 800D5328 80010004 */  lwz     r0, 4(r1)
/* 0CFD8C 800D532C 7C0803A6 */  mtlr    r0
/* 0CFD90 800D5330 4E800020 */  blr     


