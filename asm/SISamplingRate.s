# SISamplingRate.c
.include "macros.inc"

.section .text, "ax"

.balign 4

glabel SISetSamplingRate
/* 0AC2E0 800B1880 7C0802A6 */  mflr    r0
/* 0AC2E4 800B1884 90010004 */  stw     r0, 4(r1)
/* 0AC2E8 800B1888 9421FFE0 */  stwu    r1, -0x20(r1)
/* 0AC2EC 800B188C 93E1001C */  stw     r31, 0x1c(r1)
/* 0AC2F0 800B1890 93C10018 */  stw     r30, 0x18(r1)
/* 0AC2F4 800B1894 93A10014 */  stw     r29, 0x14(r1)
/* 0AC2F8 800B1898 3BA30000 */  addi    r29, r3, 0
/* 0AC2FC 800B189C 281D000B */  cmplwi  r29, 0xb
/* 0AC300 800B18A0 3C608010 */  lis     r3, XYNTSC@ha
/* 0AC304 800B18A4 3BE3F688 */  addi    r31, r3, XYNTSC@l
/* 0AC308 800B18A8 40810008 */  ble     lbl_800B18B0
/* 0AC30C 800B18AC 3BA0000B */  li      r29, 0xb
lbl_800B18B0:
/* 0AC310 800B18B0 4BFF8EC1 */  bl      OSDisableInterrupts
/* 0AC314 800B18B4 93AD91B0 */  stw     r29, SamplingRate-_SDA_BASE_(r13)
/* 0AC318 800B18B8 7C7E1B78 */  mr      r30, r3
/* 0AC31C 800B18BC 48001BB5 */  bl      VIGetTvFormat
/* 0AC320 800B18C0 2C030002 */  cmpwi   r3, 2
/* 0AC324 800B18C4 41820024 */  beq     lbl_800B18E8
/* 0AC328 800B18C8 40800014 */  bge     lbl_800B18DC
/* 0AC32C 800B18CC 2C030000 */  cmpwi   r3, 0
/* 0AC330 800B18D0 41820018 */  beq     lbl_800B18E8
/* 0AC334 800B18D4 4080001C */  bge     lbl_800B18F0
/* 0AC338 800B18D8 48000020 */  b       lbl_800B18F8
lbl_800B18DC:
/* 0AC33C 800B18DC 2C030005 */  cmpwi   r3, 5
/* 0AC340 800B18E0 41820008 */  beq     lbl_800B18E8
/* 0AC344 800B18E4 48000014 */  b       lbl_800B18F8
lbl_800B18E8:
/* 0AC348 800B18E8 7FE4FB78 */  mr      r4, r31
/* 0AC34C 800B18EC 48000020 */  b       lbl_800B190C
lbl_800B18F0:
/* 0AC350 800B18F0 389F0030 */  addi    r4, r31, 0x30
/* 0AC354 800B18F4 48000018 */  b       lbl_800B190C
lbl_800B18F8:
/* 0AC358 800B18F8 387F0060 */  addi    r3, r31, 0x60
/* 0AC35C 800B18FC 4CC63182 */  crclr   6
/* 0AC360 800B1900 4BFF876D */  bl      OSReport
/* 0AC364 800B1904 3BA00000 */  li      r29, 0
/* 0AC368 800B1908 389F0000 */  addi    r4, r31, 0
lbl_800B190C:
/* 0AC36C 800B190C 3C60CC00 */  lis     r3, 0xcc00
/* 0AC370 800B1910 A003206C */  lhz     r0, 0x206c(r3)
/* 0AC374 800B1914 540007FF */  clrlwi. r0, r0, 0x1f
/* 0AC378 800B1918 4182000C */  beq     lbl_800B1924
/* 0AC37C 800B191C 38A00002 */  li      r5, 2
/* 0AC380 800B1920 48000008 */  b       lbl_800B1928
lbl_800B1924:
/* 0AC384 800B1924 38A00001 */  li      r5, 1
lbl_800B1928:
/* 0AC388 800B1928 57A3103A */  slwi    r3, r29, 2
/* 0AC38C 800B192C 7C041A2E */  lhzx    r0, r4, r3
/* 0AC390 800B1930 7C641A14 */  add     r3, r4, r3
/* 0AC394 800B1934 88830002 */  lbz     r4, 2(r3)
/* 0AC398 800B1938 7C6501D6 */  mullw   r3, r5, r0
/* 0AC39C 800B193C 4BFFF4A9 */  bl      SISetXY
/* 0AC3A0 800B1940 7FC3F378 */  mr      r3, r30
/* 0AC3A4 800B1944 4BFF8E55 */  bl      OSRestoreInterrupts
/* 0AC3A8 800B1948 80010024 */  lwz     r0, 0x24(r1)
/* 0AC3AC 800B194C 83E1001C */  lwz     r31, 0x1c(r1)
/* 0AC3B0 800B1950 83C10018 */  lwz     r30, 0x18(r1)
/* 0AC3B4 800B1954 83A10014 */  lwz     r29, 0x14(r1)
/* 0AC3B8 800B1958 38210020 */  addi    r1, r1, 0x20
/* 0AC3BC 800B195C 7C0803A6 */  mtlr    r0
/* 0AC3C0 800B1960 4E800020 */  blr     

glabel SIRefreshSamplingRate
/* 0AC3C4 800B1964 7C0802A6 */  mflr    r0
/* 0AC3C8 800B1968 90010004 */  stw     r0, 4(r1)
/* 0AC3CC 800B196C 9421FFF8 */  stwu    r1, -8(r1)
/* 0AC3D0 800B1970 806D91B0 */  lwz     r3, SamplingRate-_SDA_BASE_(r13)
/* 0AC3D4 800B1974 4BFFFF0D */  bl      SISetSamplingRate
/* 0AC3D8 800B1978 8001000C */  lwz     r0, 0xc(r1)
/* 0AC3DC 800B197C 38210008 */  addi    r1, r1, 8
/* 0AC3E0 800B1980 7C0803A6 */  mtlr    r0
/* 0AC3E4 800B1984 4E800020 */  blr     


.section .data, "wa"

.balign 8

/* 000FC708 800FF688 0030 */
XYNTSC:
    .long 0x00F60200, 0x000F1200, 0x001E0900, 0x002C0600, 0x00340500, 0x00410400, 0x00570300, 0x00570300
    .long 0x00570300, 0x00830200, 0x00830200, 0x00830200

.balign 4

/* 000FC738 800FF6B8 0030 */
XYPAL:
    .long 0x01280200, 0x000F1500, 0x001D0B00, 0x002D0700, 0x00340600, 0x003F0500, 0x004E0400, 0x00680300
    .long 0x00680300, 0x00680300, 0x00680300, 0x009C0200

.balign 4

/* 000FC768 800FF6E8 0033 */
D_800FF6E8:
    .asciz "SISetSamplingRate: unknown TV format. Use default."


.section .sbss, "wa"

.balign 8

/* 001003F0 80145B90 0004 */
SamplingRate:
    .skip 4


