# OSCache.c
.include "macros.inc"

.section .text, "ax"

.balign 4

glabel DCEnable
/* 0A3C10 800A91B0 7C0004AC */  sync    0
/* 0A3C14 800A91B4 7C70FAA6 */  mfspr   r3, 0x3f0
/* 0A3C18 800A91B8 60634000 */  ori     r3, r3, 0x4000
/* 0A3C1C 800A91BC 7C70FBA6 */  mtspr   0x3f0, r3
/* 0A3C20 800A91C0 4E800020 */  blr     

glabel DCInvalidateRange
/* 0A3C24 800A91C4 28040000 */  cmplwi  r4, 0
/* 0A3C28 800A91C8 4C810020 */  blelr   
/* 0A3C2C 800A91CC 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3C30 800A91D0 7C842A14 */  add     r4, r4, r5
/* 0A3C34 800A91D4 3884001F */  addi    r4, r4, 0x1f
/* 0A3C38 800A91D8 5484D97E */  srwi    r4, r4, 5
/* 0A3C3C 800A91DC 7C8903A6 */  mtctr   r4
lbl_800A91E0:
/* 0A3C40 800A91E0 7C001BAC */  dcbi    0, r3
/* 0A3C44 800A91E4 38630020 */  addi    r3, r3, 0x20
/* 0A3C48 800A91E8 4200FFF8 */  bdnz    lbl_800A91E0
/* 0A3C4C 800A91EC 4E800020 */  blr     

glabel DCFlushRange
/* 0A3C50 800A91F0 28040000 */  cmplwi  r4, 0
/* 0A3C54 800A91F4 4C810020 */  blelr   
/* 0A3C58 800A91F8 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3C5C 800A91FC 7C842A14 */  add     r4, r4, r5
/* 0A3C60 800A9200 3884001F */  addi    r4, r4, 0x1f
/* 0A3C64 800A9204 5484D97E */  srwi    r4, r4, 5
/* 0A3C68 800A9208 7C8903A6 */  mtctr   r4
lbl_800A920C:
/* 0A3C6C 800A920C 7C0018AC */  dcbf    0, r3
/* 0A3C70 800A9210 38630020 */  addi    r3, r3, 0x20
/* 0A3C74 800A9214 4200FFF8 */  bdnz    lbl_800A920C
/* 0A3C78 800A9218 44000002 */  sc      
/* 0A3C7C 800A921C 4E800020 */  blr     

glabel DCStoreRange
/* 0A3C80 800A9220 28040000 */  cmplwi  r4, 0
/* 0A3C84 800A9224 4C810020 */  blelr   
/* 0A3C88 800A9228 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3C8C 800A922C 7C842A14 */  add     r4, r4, r5
/* 0A3C90 800A9230 3884001F */  addi    r4, r4, 0x1f
/* 0A3C94 800A9234 5484D97E */  srwi    r4, r4, 5
/* 0A3C98 800A9238 7C8903A6 */  mtctr   r4
lbl_800A923C:
/* 0A3C9C 800A923C 7C00186C */  dcbst   0, r3
/* 0A3CA0 800A9240 38630020 */  addi    r3, r3, 0x20
/* 0A3CA4 800A9244 4200FFF8 */  bdnz    lbl_800A923C
/* 0A3CA8 800A9248 44000002 */  sc      
/* 0A3CAC 800A924C 4E800020 */  blr     

glabel DCFlushRangeNoSync
/* 0A3CB0 800A9250 28040000 */  cmplwi  r4, 0
/* 0A3CB4 800A9254 4C810020 */  blelr   
/* 0A3CB8 800A9258 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3CBC 800A925C 7C842A14 */  add     r4, r4, r5
/* 0A3CC0 800A9260 3884001F */  addi    r4, r4, 0x1f
/* 0A3CC4 800A9264 5484D97E */  srwi    r4, r4, 5
/* 0A3CC8 800A9268 7C8903A6 */  mtctr   r4
lbl_800A926C:
/* 0A3CCC 800A926C 7C0018AC */  dcbf    0, r3
/* 0A3CD0 800A9270 38630020 */  addi    r3, r3, 0x20
/* 0A3CD4 800A9274 4200FFF8 */  bdnz    lbl_800A926C
/* 0A3CD8 800A9278 4E800020 */  blr     

glabel DCZeroRange
/* 0A3CDC 800A927C 28040000 */  cmplwi  r4, 0
/* 0A3CE0 800A9280 4C810020 */  blelr   
/* 0A3CE4 800A9284 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3CE8 800A9288 7C842A14 */  add     r4, r4, r5
/* 0A3CEC 800A928C 3884001F */  addi    r4, r4, 0x1f
/* 0A3CF0 800A9290 5484D97E */  srwi    r4, r4, 5
/* 0A3CF4 800A9294 7C8903A6 */  mtctr   r4
lbl_800A9298:
/* 0A3CF8 800A9298 7C001FEC */  dcbz    0, r3
/* 0A3CFC 800A929C 38630020 */  addi    r3, r3, 0x20
/* 0A3D00 800A92A0 4200FFF8 */  bdnz    lbl_800A9298
/* 0A3D04 800A92A4 4E800020 */  blr     

glabel ICInvalidateRange
/* 0A3D08 800A92A8 28040000 */  cmplwi  r4, 0
/* 0A3D0C 800A92AC 4C810020 */  blelr   
/* 0A3D10 800A92B0 546506FE */  clrlwi  r5, r3, 0x1b
/* 0A3D14 800A92B4 7C842A14 */  add     r4, r4, r5
/* 0A3D18 800A92B8 3884001F */  addi    r4, r4, 0x1f
/* 0A3D1C 800A92BC 5484D97E */  srwi    r4, r4, 5
/* 0A3D20 800A92C0 7C8903A6 */  mtctr   r4
lbl_800A92C4:
/* 0A3D24 800A92C4 7C001FAC */  icbi    0, r3
/* 0A3D28 800A92C8 38630020 */  addi    r3, r3, 0x20
/* 0A3D2C 800A92CC 4200FFF8 */  bdnz    lbl_800A92C4
/* 0A3D30 800A92D0 7C0004AC */  sync    0
/* 0A3D34 800A92D4 4C00012C */  isync   
/* 0A3D38 800A92D8 4E800020 */  blr     

glabel ICFlashInvalidate
/* 0A3D3C 800A92DC 7C70FAA6 */  mfspr   r3, 0x3f0
/* 0A3D40 800A92E0 60630800 */  ori     r3, r3, 0x800
/* 0A3D44 800A92E4 7C70FBA6 */  mtspr   0x3f0, r3
/* 0A3D48 800A92E8 4E800020 */  blr     

glabel ICEnable
/* 0A3D4C 800A92EC 4C00012C */  isync   
/* 0A3D50 800A92F0 7C70FAA6 */  mfspr   r3, 0x3f0
/* 0A3D54 800A92F4 60638000 */  ori     r3, r3, 0x8000
/* 0A3D58 800A92F8 7C70FBA6 */  mtspr   0x3f0, r3
/* 0A3D5C 800A92FC 4E800020 */  blr     

__LCEnable:
/* 0A3D60 800A9300 7CA000A6 */  mfmsr   r5
/* 0A3D64 800A9304 60A51000 */  ori     r5, r5, 0x1000
/* 0A3D68 800A9308 7CA00124 */  mtmsr   r5
/* 0A3D6C 800A930C 3C608000 */  lis     r3, 0x8000
/* 0A3D70 800A9310 38800400 */  li      r4, 0x400
/* 0A3D74 800A9314 7C8903A6 */  mtctr   r4
lbl_800A9318:
/* 0A3D78 800A9318 7C001A2C */  dcbt    0, r3
/* 0A3D7C 800A931C 7C00186C */  dcbst   0, r3
/* 0A3D80 800A9320 38630020 */  addi    r3, r3, 0x20
/* 0A3D84 800A9324 4200FFF4 */  bdnz    lbl_800A9318
/* 0A3D88 800A9328 7C98E2A6 */  mfspr   r4, 0x398
/* 0A3D8C 800A932C 6484100F */  oris    r4, r4, 0x100f
/* 0A3D90 800A9330 7C98E3A6 */  mtspr   0x398, r4
/* 0A3D94 800A9334 60000000 */  nop     
/* 0A3D98 800A9338 60000000 */  nop     
/* 0A3D9C 800A933C 60000000 */  nop     
/* 0A3DA0 800A9340 60000000 */  nop     
/* 0A3DA4 800A9344 60000000 */  nop     
/* 0A3DA8 800A9348 60000000 */  nop     
/* 0A3DAC 800A934C 60000000 */  nop     
/* 0A3DB0 800A9350 60000000 */  nop     
/* 0A3DB4 800A9354 60000000 */  nop     
/* 0A3DB8 800A9358 60000000 */  nop     
/* 0A3DBC 800A935C 60000000 */  nop     
/* 0A3DC0 800A9360 60000000 */  nop     
/* 0A3DC4 800A9364 3C60E000 */  lis     r3, 0xe000
/* 0A3DC8 800A9368 60630002 */  ori     r3, r3, 2
/* 0A3DCC 800A936C 7C7F83A6 */  mtdbatl 3, r3
/* 0A3DD0 800A9370 606301FE */  ori     r3, r3, 0x1fe
/* 0A3DD4 800A9374 7C7E83A6 */  mtdbatu 3, r3
/* 0A3DD8 800A9378 4C00012C */  isync   
/* 0A3DDC 800A937C 3C60E000 */  lis     r3, 0xe000
/* 0A3DE0 800A9380 38C00200 */  li      r6, 0x200
/* 0A3DE4 800A9384 7CC903A6 */  mtctr   r6
/* 0A3DE8 800A9388 38C00000 */  li      r6, 0
lbl_800A938C:
/* 0A3DEC 800A938C 10061FEC */  dcbz_l  r6, r3
/* 0A3DF0 800A9390 38630020 */  addi    r3, r3, 0x20
/* 0A3DF4 800A9394 4200FFF8 */  bdnz    lbl_800A938C
/* 0A3DF8 800A9398 60000000 */  nop     
/* 0A3DFC 800A939C 60000000 */  nop     
/* 0A3E00 800A93A0 60000000 */  nop     
/* 0A3E04 800A93A4 60000000 */  nop     
/* 0A3E08 800A93A8 60000000 */  nop     
/* 0A3E0C 800A93AC 60000000 */  nop     
/* 0A3E10 800A93B0 60000000 */  nop     
/* 0A3E14 800A93B4 60000000 */  nop     
/* 0A3E18 800A93B8 60000000 */  nop     
/* 0A3E1C 800A93BC 60000000 */  nop     
/* 0A3E20 800A93C0 60000000 */  nop     
/* 0A3E24 800A93C4 60000000 */  nop     
/* 0A3E28 800A93C8 4E800020 */  blr     

glabel LCEnable
/* 0A3E2C 800A93CC 7C0802A6 */  mflr    r0
/* 0A3E30 800A93D0 90010004 */  stw     r0, 4(r1)
/* 0A3E34 800A93D4 9421FFF0 */  stwu    r1, -0x10(r1)
/* 0A3E38 800A93D8 93E1000C */  stw     r31, 0xc(r1)
/* 0A3E3C 800A93DC 48001395 */  bl      OSDisableInterrupts
/* 0A3E40 800A93E0 7C7F1B78 */  mr      r31, r3
/* 0A3E44 800A93E4 4BFFFF1D */  bl      __LCEnable
/* 0A3E48 800A93E8 7FE3FB78 */  mr      r3, r31
/* 0A3E4C 800A93EC 480013AD */  bl      OSRestoreInterrupts
/* 0A3E50 800A93F0 80010014 */  lwz     r0, 0x14(r1)
/* 0A3E54 800A93F4 83E1000C */  lwz     r31, 0xc(r1)
/* 0A3E58 800A93F8 38210010 */  addi    r1, r1, 0x10
/* 0A3E5C 800A93FC 7C0803A6 */  mtlr    r0
/* 0A3E60 800A9400 4E800020 */  blr     

glabel LCDisable
/* 0A3E64 800A9404 3C60E000 */  lis     r3, 0xe000
/* 0A3E68 800A9408 38800200 */  li      r4, 0x200
/* 0A3E6C 800A940C 7C8903A6 */  mtctr   r4
lbl_800A9410:
/* 0A3E70 800A9410 7C001BAC */  dcbi    0, r3
/* 0A3E74 800A9414 38630020 */  addi    r3, r3, 0x20
/* 0A3E78 800A9418 4200FFF8 */  bdnz    lbl_800A9410
/* 0A3E7C 800A941C 7C98E2A6 */  mfspr   r4, 0x398
/* 0A3E80 800A9420 54840104 */  rlwinm  r4, r4, 0, 4, 2
/* 0A3E84 800A9424 7C98E3A6 */  mtspr   0x398, r4
/* 0A3E88 800A9428 4E800020 */  blr     

glabel LCStoreBlocks
/* 0A3E8C 800A942C 54A6F6FE */  rlwinm  r6, r5, 0x1e, 0x1b, 0x1f
/* 0A3E90 800A9430 5463013E */  clrlwi  r3, r3, 4
/* 0A3E94 800A9434 7CC61B78 */  or      r6, r6, r3
/* 0A3E98 800A9438 7CDAE3A6 */  mtspr   0x39a, r6
/* 0A3E9C 800A943C 54A6173A */  rlwinm  r6, r5, 2, 0x1c, 0x1d
/* 0A3EA0 800A9440 7CC62378 */  or      r6, r6, r4
/* 0A3EA4 800A9444 60C60002 */  ori     r6, r6, 2
/* 0A3EA8 800A9448 7CDBE3A6 */  mtspr   0x39b, r6
/* 0A3EAC 800A944C 4E800020 */  blr     

glabel LCStoreData
/* 0A3EB0 800A9450 7C0802A6 */  mflr    r0
/* 0A3EB4 800A9454 90010004 */  stw     r0, 4(r1)
/* 0A3EB8 800A9458 9421FFD8 */  stwu    r1, -0x28(r1)
/* 0A3EBC 800A945C 93E10024 */  stw     r31, 0x24(r1)
/* 0A3EC0 800A9460 93C10020 */  stw     r30, 0x20(r1)
/* 0A3EC4 800A9464 93A1001C */  stw     r29, 0x1c(r1)
/* 0A3EC8 800A9468 93810018 */  stw     r28, 0x18(r1)
/* 0A3ECC 800A946C 7C7C1B78 */  mr      r28, r3
/* 0A3ED0 800A9470 7C9D2378 */  mr      r29, r4
/* 0A3ED4 800A9474 3805001F */  addi    r0, r5, 0x1f
/* 0A3ED8 800A9478 5403D97E */  srwi    r3, r0, 5
/* 0A3EDC 800A947C 3803007F */  addi    r0, r3, 0x7f
/* 0A3EE0 800A9480 7C7F1B78 */  mr      r31, r3
/* 0A3EE4 800A9484 541EC9FE */  srwi    r30, r0, 7
/* 0A3EE8 800A9488 48000004 */  b       lbl_800A948C
lbl_800A948C:
/* 0A3EEC 800A948C 48000004 */  b       lbl_800A9490
lbl_800A9490:
/* 0A3EF0 800A9490 48000040 */  b       lbl_800A94D0
lbl_800A9494:
/* 0A3EF4 800A9494 281F0080 */  cmplwi  r31, 0x80
/* 0A3EF8 800A9498 4080001C */  bge     lbl_800A94B4
/* 0A3EFC 800A949C 7F83E378 */  mr      r3, r28
/* 0A3F00 800A94A0 7FA4EB78 */  mr      r4, r29
/* 0A3F04 800A94A4 7FE5FB78 */  mr      r5, r31
/* 0A3F08 800A94A8 4BFFFF85 */  bl      LCStoreBlocks
/* 0A3F0C 800A94AC 3BE00000 */  li      r31, 0
/* 0A3F10 800A94B0 48000020 */  b       lbl_800A94D0
lbl_800A94B4:
/* 0A3F14 800A94B4 7F83E378 */  mr      r3, r28
/* 0A3F18 800A94B8 7FA4EB78 */  mr      r4, r29
/* 0A3F1C 800A94BC 38A00000 */  li      r5, 0
/* 0A3F20 800A94C0 4BFFFF6D */  bl      LCStoreBlocks
/* 0A3F24 800A94C4 3BFFFF80 */  addi    r31, r31, -128
/* 0A3F28 800A94C8 3B9C1000 */  addi    r28, r28, 0x1000
/* 0A3F2C 800A94CC 3BBD1000 */  addi    r29, r29, 0x1000
lbl_800A94D0:
/* 0A3F30 800A94D0 281F0000 */  cmplwi  r31, 0
/* 0A3F34 800A94D4 4082FFC0 */  bne     lbl_800A9494
/* 0A3F38 800A94D8 7FC3F378 */  mr      r3, r30
/* 0A3F3C 800A94DC 8001002C */  lwz     r0, 0x2c(r1)
/* 0A3F40 800A94E0 83E10024 */  lwz     r31, 0x24(r1)
/* 0A3F44 800A94E4 83C10020 */  lwz     r30, 0x20(r1)
/* 0A3F48 800A94E8 83A1001C */  lwz     r29, 0x1c(r1)
/* 0A3F4C 800A94EC 83810018 */  lwz     r28, 0x18(r1)
/* 0A3F50 800A94F0 38210028 */  addi    r1, r1, 0x28
/* 0A3F54 800A94F4 7C0803A6 */  mtlr    r0
/* 0A3F58 800A94F8 4E800020 */  blr     

glabel LCQueueWait
/* 0A3F5C 800A94FC 7C98E2A6 */  mfspr   r4, 0x398
/* 0A3F60 800A9500 5484473E */  rlwinm  r4, r4, 8, 0x1c, 0x1f
/* 0A3F64 800A9504 7C041800 */  cmpw    r4, r3
/* 0A3F68 800A9508 4181FFF4 */  bgt     LCQueueWait
/* 0A3F6C 800A950C 4E800020 */  blr     

glabel L2GlobalInvalidate
/* 0A3F70 800A9510 7C0802A6 */  mflr    r0
/* 0A3F74 800A9514 90010004 */  stw     r0, 4(r1)
/* 0A3F78 800A9518 9421FFF0 */  stwu    r1, -0x10(r1)
/* 0A3F7C 800A951C 93E1000C */  stw     r31, 0xc(r1)
/* 0A3F80 800A9520 7C0004AC */  sync    0
/* 0A3F84 800A9524 4BFFE02D */  bl      PPCMfl2cr
/* 0A3F88 800A9528 5463007E */  clrlwi  r3, r3, 1
/* 0A3F8C 800A952C 4BFFE02D */  bl      PPCMtl2cr
/* 0A3F90 800A9530 7C0004AC */  sync    0
/* 0A3F94 800A9534 4BFFE01D */  bl      PPCMfl2cr
/* 0A3F98 800A9538 64630020 */  oris    r3, r3, 0x20
/* 0A3F9C 800A953C 4BFFE01D */  bl      PPCMtl2cr
/* 0A3FA0 800A9540 48000004 */  b       lbl_800A9544
lbl_800A9544:
/* 0A3FA4 800A9544 48000004 */  b       lbl_800A9548
lbl_800A9548:
/* 0A3FA8 800A9548 4BFFE009 */  bl      PPCMfl2cr
/* 0A3FAC 800A954C 546007FE */  clrlwi  r0, r3, 0x1f
/* 0A3FB0 800A9550 28000000 */  cmplwi  r0, 0
/* 0A3FB4 800A9554 4082FFF4 */  bne     lbl_800A9548
/* 0A3FB8 800A9558 4BFFDFF9 */  bl      PPCMfl2cr
/* 0A3FBC 800A955C 546302D2 */  rlwinm  r3, r3, 0, 0xb, 9
/* 0A3FC0 800A9560 4BFFDFF9 */  bl      PPCMtl2cr
/* 0A3FC4 800A9564 48000004 */  b       lbl_800A9568
lbl_800A9568:
/* 0A3FC8 800A9568 3C608010 */  lis     r3, D_800FEC98@ha
/* 0A3FCC 800A956C 3BE3EC98 */  addi    r31, r3, D_800FEC98@l
/* 0A3FD0 800A9570 48000004 */  b       lbl_800A9574
lbl_800A9574:
/* 0A3FD4 800A9574 48000010 */  b       lbl_800A9584
lbl_800A9578:
/* 0A3FD8 800A9578 7FE3FB78 */  mr      r3, r31
/* 0A3FDC 800A957C 4CC63182 */  crclr   6
/* 0A3FE0 800A9580 4800A271 */  bl      DBPrintf
lbl_800A9584:
/* 0A3FE4 800A9584 4BFFDFCD */  bl      PPCMfl2cr
/* 0A3FE8 800A9588 546007FE */  clrlwi  r0, r3, 0x1f
/* 0A3FEC 800A958C 28000000 */  cmplwi  r0, 0
/* 0A3FF0 800A9590 4082FFE8 */  bne     lbl_800A9578
/* 0A3FF4 800A9594 80010014 */  lwz     r0, 0x14(r1)
/* 0A3FF8 800A9598 83E1000C */  lwz     r31, 0xc(r1)
/* 0A3FFC 800A959C 38210010 */  addi    r1, r1, 0x10
/* 0A4000 800A95A0 7C0803A6 */  mtlr    r0
/* 0A4004 800A95A4 4E800020 */  blr     

glabel DMAErrorHandler
/* 0A4008 800A95A8 7C0802A6 */  mflr    r0
/* 0A400C 800A95AC 90010004 */  stw     r0, 4(r1)
/* 0A4010 800A95B0 9421FF80 */  stwu    r1, -0x80(r1)
/* 0A4014 800A95B4 93E1007C */  stw     r31, 0x7c(r1)
/* 0A4018 800A95B8 93C10078 */  stw     r30, 0x78(r1)
/* 0A401C 800A95BC 93A10074 */  stw     r29, 0x74(r1)
/* 0A4020 800A95C0 40860024 */  bne     cr1, lbl_800A95E4
/* 0A4024 800A95C4 D8210028 */  stfd    f1, 0x28(r1)
/* 0A4028 800A95C8 D8410030 */  stfd    f2, 0x30(r1)
/* 0A402C 800A95CC D8610038 */  stfd    f3, 0x38(r1)
/* 0A4030 800A95D0 D8810040 */  stfd    f4, 0x40(r1)
/* 0A4034 800A95D4 D8A10048 */  stfd    f5, 0x48(r1)
/* 0A4038 800A95D8 D8C10050 */  stfd    f6, 0x50(r1)
/* 0A403C 800A95DC D8E10058 */  stfd    f7, 0x58(r1)
/* 0A4040 800A95E0 D9010060 */  stfd    f8, 0x60(r1)
lbl_800A95E4:
/* 0A4044 800A95E4 90610008 */  stw     r3, 8(r1)
/* 0A4048 800A95E8 9081000C */  stw     r4, 0xc(r1)
/* 0A404C 800A95EC 90A10010 */  stw     r5, 0x10(r1)
/* 0A4050 800A95F0 90C10014 */  stw     r6, 0x14(r1)
/* 0A4054 800A95F4 90E10018 */  stw     r7, 0x18(r1)
/* 0A4058 800A95F8 9101001C */  stw     r8, 0x1c(r1)
/* 0A405C 800A95FC 91210020 */  stw     r9, 0x20(r1)
/* 0A4060 800A9600 91410024 */  stw     r10, 0x24(r1)
/* 0A4064 800A9604 7C9D2378 */  mr      r29, r4
/* 0A4068 800A9608 3C608010 */  lis     r3, D_800FEC98@ha
/* 0A406C 800A960C 3BE3EC98 */  addi    r31, r3, D_800FEC98@l
/* 0A4070 800A9610 4BFFDFED */  bl      PPCMfhid2
/* 0A4074 800A9614 7C7E1B78 */  mr      r30, r3
/* 0A4078 800A9618 4CC63182 */  crclr   6
/* 0A407C 800A961C 387F002C */  addi    r3, r31, 0x2c
/* 0A4080 800A9620 48000A4D */  bl      OSReport
/* 0A4084 800A9624 80BD019C */  lwz     r5, 0x19c(r29)
/* 0A4088 800A9628 7FC4F378 */  mr      r4, r30
/* 0A408C 800A962C 387F0044 */  addi    r3, r31, 0x44
/* 0A4090 800A9630 4CC63182 */  crclr   6
/* 0A4094 800A9634 48000A39 */  bl      OSReport
/* 0A4098 800A9638 57C00216 */  rlwinm  r0, r30, 0, 8, 0xb
/* 0A409C 800A963C 28000000 */  cmplwi  r0, 0
/* 0A40A0 800A9640 41820014 */  beq     lbl_800A9654
/* 0A40A4 800A9644 801D019C */  lwz     r0, 0x19c(r29)
/* 0A40A8 800A9648 54000294 */  rlwinm  r0, r0, 0, 0xa, 0xa
/* 0A40AC 800A964C 28000000 */  cmplwi  r0, 0
/* 0A40B0 800A9650 4082001C */  bne     lbl_800A966C
lbl_800A9654:
/* 0A40B4 800A9654 387F0060 */  addi    r3, r31, 0x60
/* 0A40B8 800A9658 4CC63182 */  crclr   6
/* 0A40BC 800A965C 48000A11 */  bl      OSReport
/* 0A40C0 800A9660 7FA3EB78 */  mr      r3, r29
/* 0A40C4 800A9664 48000695 */  bl      OSDumpContext
/* 0A40C8 800A9668 4BFFDF09 */  bl      PPCHalt
lbl_800A966C:
/* 0A40CC 800A966C 387F0090 */  addi    r3, r31, 0x90
/* 0A40D0 800A9670 4CC63182 */  crclr   6
/* 0A40D4 800A9674 480009F9 */  bl      OSReport
/* 0A40D8 800A9678 387F00CC */  addi    r3, r31, 0xcc
/* 0A40DC 800A967C 4CC63182 */  crclr   6
/* 0A40E0 800A9680 480009ED */  bl      OSReport
/* 0A40E4 800A9684 57C00210 */  rlwinm  r0, r30, 0, 8, 8
/* 0A40E8 800A9688 28000000 */  cmplwi  r0, 0
/* 0A40EC 800A968C 41820010 */  beq     lbl_800A969C
/* 0A40F0 800A9690 387F0104 */  addi    r3, r31, 0x104
/* 0A40F4 800A9694 4CC63182 */  crclr   6
/* 0A40F8 800A9698 480009D5 */  bl      OSReport
lbl_800A969C:
/* 0A40FC 800A969C 57C00252 */  rlwinm  r0, r30, 0, 9, 9
/* 0A4100 800A96A0 28000000 */  cmplwi  r0, 0
/* 0A4104 800A96A4 41820010 */  beq     lbl_800A96B4
/* 0A4108 800A96A8 387F0144 */  addi    r3, r31, 0x144
/* 0A410C 800A96AC 4CC63182 */  crclr   6
/* 0A4110 800A96B0 480009BD */  bl      OSReport
lbl_800A96B4:
/* 0A4114 800A96B4 57C00294 */  rlwinm  r0, r30, 0, 0xa, 0xa
/* 0A4118 800A96B8 28000000 */  cmplwi  r0, 0
/* 0A411C 800A96BC 41820010 */  beq     lbl_800A96CC
/* 0A4120 800A96C0 387F0170 */  addi    r3, r31, 0x170
/* 0A4124 800A96C4 4CC63182 */  crclr   6
/* 0A4128 800A96C8 480009A5 */  bl      OSReport
lbl_800A96CC:
/* 0A412C 800A96CC 57C002D6 */  rlwinm  r0, r30, 0, 0xb, 0xb
/* 0A4130 800A96D0 28000000 */  cmplwi  r0, 0
/* 0A4134 800A96D4 41820010 */  beq     lbl_800A96E4
/* 0A4138 800A96D8 387F0190 */  addi    r3, r31, 0x190
/* 0A413C 800A96DC 4CC63182 */  crclr   6
/* 0A4140 800A96E0 4800098D */  bl      OSReport
lbl_800A96E4:
/* 0A4144 800A96E4 7FC3F378 */  mr      r3, r30
/* 0A4148 800A96E8 4BFFDF1D */  bl      PPCMthid2
/* 0A414C 800A96EC 80010084 */  lwz     r0, 0x84(r1)
/* 0A4150 800A96F0 83E1007C */  lwz     r31, 0x7c(r1)
/* 0A4154 800A96F4 83C10078 */  lwz     r30, 0x78(r1)
/* 0A4158 800A96F8 83A10074 */  lwz     r29, 0x74(r1)
/* 0A415C 800A96FC 38210080 */  addi    r1, r1, 0x80
/* 0A4160 800A9700 7C0803A6 */  mtlr    r0
/* 0A4164 800A9704 4E800020 */  blr     

glabel __OSCacheInit
/* 0A4168 800A9708 7C0802A6 */  mflr    r0
/* 0A416C 800A970C 90010004 */  stw     r0, 4(r1)
/* 0A4170 800A9710 9421FFF0 */  stwu    r1, -0x10(r1)
/* 0A4174 800A9714 93E1000C */  stw     r31, 0xc(r1)
/* 0A4178 800A9718 93C10008 */  stw     r30, 8(r1)
/* 0A417C 800A971C 3C608010 */  lis     r3, D_800FEC98@ha
/* 0A4180 800A9720 3BE3EC98 */  addi    r31, r3, D_800FEC98@l
/* 0A4184 800A9724 4BFFDE1D */  bl      PPCMfhid0
/* 0A4188 800A9728 54600420 */  rlwinm  r0, r3, 0, 0x10, 0x10
/* 0A418C 800A972C 28000000 */  cmplwi  r0, 0
/* 0A4190 800A9730 40820014 */  bne     lbl_800A9744
/* 0A4194 800A9734 4BFFFBB9 */  bl      ICEnable
/* 0A4198 800A9738 387F01AC */  addi    r3, r31, 0x1ac
/* 0A419C 800A973C 4CC63182 */  crclr   6
/* 0A41A0 800A9740 4800A0B1 */  bl      DBPrintf
lbl_800A9744:
/* 0A41A4 800A9744 4BFFDDFD */  bl      PPCMfhid0
/* 0A41A8 800A9748 54600462 */  rlwinm  r0, r3, 0, 0x11, 0x11
/* 0A41AC 800A974C 28000000 */  cmplwi  r0, 0
/* 0A41B0 800A9750 40820014 */  bne     lbl_800A9764
/* 0A41B4 800A9754 4BFFFA5D */  bl      DCEnable
/* 0A41B8 800A9758 387F01C8 */  addi    r3, r31, 0x1c8
/* 0A41BC 800A975C 4CC63182 */  crclr   6
/* 0A41C0 800A9760 4800A091 */  bl      DBPrintf
lbl_800A9764:
/* 0A41C4 800A9764 4BFFDDED */  bl      PPCMfl2cr
/* 0A41C8 800A9768 54600000 */  rlwinm  r0, r3, 0, 0, 0
/* 0A41CC 800A976C 28000000 */  cmplwi  r0, 0
/* 0A41D0 800A9770 40820058 */  bne     lbl_800A97C8
/* 0A41D4 800A9774 4BFFDDBD */  bl      PPCMfmsr
/* 0A41D8 800A9778 7C7E1B78 */  mr      r30, r3
/* 0A41DC 800A977C 7C0004AC */  sync    0
/* 0A41E0 800A9780 38600030 */  li      r3, 0x30
/* 0A41E4 800A9784 4BFFDDB5 */  bl      PPCMtmsr
/* 0A41E8 800A9788 7C0004AC */  sync    0
/* 0A41EC 800A978C 7C0004AC */  sync    0
/* 0A41F0 800A9790 4BFFDDC1 */  bl      PPCMfl2cr
/* 0A41F4 800A9794 5463007E */  clrlwi  r3, r3, 1
/* 0A41F8 800A9798 4BFFDDC1 */  bl      PPCMtl2cr
/* 0A41FC 800A979C 7C0004AC */  sync    0
/* 0A4200 800A97A0 4BFFFD71 */  bl      L2GlobalInvalidate
/* 0A4204 800A97A4 7FC3F378 */  mr      r3, r30
/* 0A4208 800A97A8 4BFFDD91 */  bl      PPCMtmsr
/* 0A420C 800A97AC 4BFFDDA5 */  bl      PPCMfl2cr
/* 0A4210 800A97B0 64608000 */  oris    r0, r3, 0x8000
/* 0A4214 800A97B4 540302D2 */  rlwinm  r3, r0, 0, 0xb, 9
/* 0A4218 800A97B8 4BFFDDA1 */  bl      PPCMtl2cr
/* 0A421C 800A97BC 387F01E4 */  addi    r3, r31, 0x1e4
/* 0A4220 800A97C0 4CC63182 */  crclr   6
/* 0A4224 800A97C4 4800A02D */  bl      DBPrintf
lbl_800A97C8:
/* 0A4228 800A97C8 3C60800B */  lis     r3, DMAErrorHandler@ha
/* 0A422C 800A97CC 388395A8 */  addi    r4, r3, DMAErrorHandler@l
/* 0A4230 800A97D0 38600001 */  li      r3, 1
/* 0A4234 800A97D4 48000A45 */  bl      OSSetErrorHandler
/* 0A4238 800A97D8 387F01FC */  addi    r3, r31, 0x1fc
/* 0A423C 800A97DC 4CC63182 */  crclr   6
/* 0A4240 800A97E0 4800A011 */  bl      DBPrintf
/* 0A4244 800A97E4 80010014 */  lwz     r0, 0x14(r1)
/* 0A4248 800A97E8 83E1000C */  lwz     r31, 0xc(r1)
/* 0A424C 800A97EC 83C10008 */  lwz     r30, 8(r1)
/* 0A4250 800A97F0 38210010 */  addi    r1, r1, 0x10
/* 0A4254 800A97F4 7C0803A6 */  mtlr    r0
/* 0A4258 800A97F8 4E800020 */  blr     


.section .data, "wa"

.balign 8

/* 000FBD18 800FEC98 0029 */
D_800FEC98:
    .asciz ">>> L2 INVALIDATE : SHOULD NEVER HAPPEN\n"

.balign 4

/* 000FBD44 800FECC4 0018 */
D_800FECC4:
    .asciz "Machine check received\n"

.balign 4

/* 000FBD5C 800FECDC 001B */
D_800FECDC:
    .asciz "HID2 = 0x%x   SRR1 = 0x%x\n"

.balign 4

/* 000FBD78 800FECF8 0030 */
D_800FECF8:
    .asciz "Machine check was not DMA/locked cache related\n"

.balign 4

/* 000FBDA8 800FED28 003C */
D_800FED28:
    .asciz "DMAErrorHandler(): An error occurred while processing DMA.\n"

.balign 4

/* 000FBDE4 800FED64 0037 */
D_800FED64:
    .asciz "The following errors have been detected and cleared :\n"

.balign 4

/* 000FBE1C 800FED9C 003F */
D_800FED9C:
    .asciz "\t- Requested a locked cache tag that was already in the cache\n"

.balign 4

/* 000FBE5C 800FEDDC 0029 */
D_800FEDDC:
    .asciz "\t- DMA attempted to access normal cache\n"

.balign 4

/* 000FBE88 800FEE08 001D */
D_800FEE08:
    .asciz "\t- DMA missed in data cache\n"

.balign 4

/* 000FBEA8 800FEE28 0019 */
D_800FEE28:
    .asciz "\t- DMA queue overflowed\n"

.balign 4

/* 000FBEC4 800FEE44 0019 */
D_800FEE44:
    .asciz "L1 i-caches initialized\n"

.balign 4

/* 000FBEE0 800FEE60 0019 */
D_800FEE60:
    .asciz "L1 d-caches initialized\n"

.balign 4

/* 000FBEFC 800FEE7C 0016 */
D_800FEE7C:
    .asciz "L2 cache initialized\n"

.balign 4

/* 000FBF14 800FEE94 002E */
D_800FEE94:
    .asciz "Locked cache machine check handler installed\n"


